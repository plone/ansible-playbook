---

- name: Install software-properties-common
  package:
    name: "software-properties-common"
    state: latest

- name: Add universe repository
  command: "add-apt-repository universe"

- name: Check for python3-certbot-nginx
  command: "apt-cache search python3-certbot-nginx"
  register: pcn_present

- name: Add certbot repository if not present
  command: "add-apt-repository ppa:certbot/certbot"
  when: pcn_present.failed

- name: Update packages via apt
  when: ansible_os_family == 'Debian'
  apt: upgrade=dist update_cache=yes

- name: Install python3-certbot-nginx
  package:
    name: "python3-certbot-nginx"
    state: latest
